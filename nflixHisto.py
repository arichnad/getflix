#!/usr/bin/python

##########################################################
# This script has been created by
# Copyright 2006 Devanshu Mehta
#  of http://www.scienceaddiction.com
# It is released under the GNU General Public License v2
#    This program is free software; you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation; either version 2 of the License, or
#    (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with this program; if not, write to the Free Software
#    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
#
# This file will generate a histogram of the netflix data generated by
# the getflix.pl script. Please run getflix.pl first!


rating=[0,0,0,0,0]
i=0
yearh= {1900:0, 1901:0}
yearhr={1900:0.0}
yearhr5={1900:0.0}

mpaah={'PG':0, 'R':0, 'PG-13':0, 'UR':0, 'G':0, 'NC-17':0, 'NR':0}
mpaahr={'PG':0.0, 'R':0.0, 'PG-13':0.0, 'UR':0.0, 'G':0.0, 'NC-17':0.0, 'NR':0.0}
mpaahr5={'PG':0.0, 'R':0.0, 'PG-13':0.0, 'UR':0.0, 'G':0.0, 'NC-17':0.0, 'NR':0.0}

genreh={'Foreign':0, 'Drama':0, 'Independent':0, 'Classics':0, 'Television':0, 'Children & Family':0, 'Sci-Fi & Fantasy':0, 'Comedy':0, 'Romance':0, 'Action & Adventure':0, 'Horror':0, 'Documentary':0, 'Thrillers':0, 'Music & Musicals':0, 'Anime & Animation':0, 'Gay & Lesbian':0}
genrehr={'Foreign':0.0, 'Drama':0.0, 'Independent':0.0, 'Classics':0.0, 'Television':0.0, 'Children & Family':0.0, 'Sci-Fi & Fantasy':0.0, 'Comedy':0.0, 'Romance':0.0, 'Action & Adventure':0.0, 'Horror':0.0, 'Documentary':0.0, 'Thrillers':0.0, 'Music & Musicals':0.0, 'Anime & Animation':0.0, 'Gay & Lesbian':0.0}
genrehr5={'Foreign':0.0, 'Drama':0.0, 'Independent':0.0, 'Classics':0.0, 'Television':0.0, 'Children & Family':0.0, 'Sci-Fi & Fantasy':0.0, 'Comedy':0.0, 'Romance':0.0, 'Action & Adventure':0.0, 'Horror':0.0, 'Documentary':0.0, 'Thrillers':0.0, 'Music & Musicals':0.0, 'Anime & Animation':0.0, 'Gay & Lesbian':0.0}


decadehr={'1':0}
decadeh={'1':0}
decadehr5={'1':0}

for i in range (0,10):
    decadehr[str(i)]=0.0
    decadeh[str(i)]=0
    decadehr5[str(i)]=0.0
i=0

idfile=open('idfile.txt','w')

for i in range(1900,2007):
    yearh[str(i)]=0
    yearhr[str(i)]=0.0
    yearhr5[str(i)]=0.0

for line in open('nflicks.txt').xreadlines( ):
    arr=line.split('~')
    rat=int(arr.pop())
    genre=arr.pop()
    mpaa=arr.pop()
    year=arr.pop()
    name=arr.pop()
    id=arr.pop()
    rating[rat-1]=rating[rat-1]+1
    genreh[genre]=genreh[genre]+1
    if genre != 'Television':
	decadeh[year[2]]=decadeh[year[2]]+1
	decadehr[year[2]]=decadehr[year[2]]+rat
	yearh[year]=yearh[year]+1
	yearhr[year]=yearhr[year]+rat
	mpaah[mpaa]=mpaah[mpaa]+1
	mpaahr[mpaa]=mpaahr[mpaa]+rat
	genrehr[genre]=genrehr[genre]+rat
	if rat==5 :
	    decadehr5[year[2]]=decadehr5[year[2]]+1
	    yearhr5[year]=yearhr5[year]+1
	    mpaahr5[mpaa]=mpaahr5[mpaa]+1
	    genrehr5[genre]=genrehr5[genre]+1
	tempstr=id+"~"+str(rat)+"\n"
	idfile.write(tempstr)

print
print "Number of Films per Ratings from 1-5"
for x in range(0,5):
    print "Star-Rating "+str(x+1)+".0: "+str(rating[x])

mpaas=['G','PG','PG-13','R','NC-17','UR','NR']
print
print "MPAA\t#films\t \tAve. Rating"
for m in mpaas:
    print '%s \t %3d \t %2.2f \t %1.4f' % (m, mpaah[m],decadehr[str(x)]/decadeh[str(x)],mpaahr[m]/mpaah[m])

#    print m+":\t"+str(mpaah[m])+"\t"+str(mpaahr5[m]*100.0/mpaah[m])+"\t"+str(mpaahr[m]/mpaah[m])

genres=['Drama', 'Comedy', 'Independent', 'Classics', 'Romance', 'Thrillers', 'Sci-Fi & Fantasy', 'Action & Adventure', 'Foreign', 'Documentary', 'Horror', 'Children & Family']

print
print "Genre\t\t  #films\t% 5star\tAve Rating"
for g in genres:
    print '%-20s %3d \t %2.2f \t %1.4f' % (g,genreh[g],genrehr5[g]*100.0/genreh[g],genrehr[g]/genreh[g])

print
print "Decade\t#films\t% 5star\tAve Rating"
for x in range(0,10):
    if decadeh[str(x)] != 0 :
	print '%d0s \t %3d \t %2.2f \t %1.4f' % (x,decadeh[str(x)],decadehr5[str(x)]*100.0/decadeh[str(x)],decadehr[str(x)]/decadeh[str(x)])


print
print "Year\t#films\t% 5star\tAve Rating"
for x in range(1990,2006):
    if yearh[str(x)] != 0 :
	print '%d \t %3d \t %2.2f \t %1.4f' % (x,yearh[str(x)],yearhr5[str(x)]*100.0/yearh[str(x)],yearhr[str(x)]/yearh[str(x)])
#	print str(x)+":\t"+str(yearh[str(x)])+"\t"+str(yearhr5[str(x)]*100.0/yearh[str(x)])+"\t"+str(yearhr[str(x)]/yearh[str(x)])
